cases("https://api.coronavirus.data.gov.uk/v1/data?"+"filters=areaType="+getCookie("areaType")+";areaName="+getCookie("areaName")+"&"+"structure={"+'"date":"date",'+'"newCasesBySpecimenDateAgeDemographics":"newCasesBySpecimenDateAgeDemographics"'+"}");async function cases(e){const a=await fetch(e);const t=await a.json();const o=t.data.reverse();const r=[],s=[],l=[[],[],[],[],[]],n=[];const h=baseArr(),g=baseArr(),c=baseArrAv(),i=baseArr(),p=baseArr(),u=baseArr(),d=baseArr(),k=baseArr(),B=baseArr();const S=[],f=[],m=[],w=[],y=[],C=[];for(let t=0;t<o.length;t++){const L=new Date(o[t].date);if(L>new Date("2020-08-27")){r.push(L.getDate()+"-"+(L.getMonth()+1));for(let a=0;a<o[t].newCasesBySpecimenDateAgeDemographics.length;a++){for(let e=0;e<ageBrackets.length;e++){if(o[t].newCasesBySpecimenDateAgeDemographics[a].age===ageBrackets[e]){h[e].push(o[t].newCasesBySpecimenDateAgeDemographics[a].cases);g[e].push(o[t].newCasesBySpecimenDateAgeDemographics[a].rollingRate)}}}}}for(let e=r.length-howLongBack;e<r.length;e++){s.push(r[e])}console.log(h);for(let t=0;t<h[0].length;t++){let a=0;for(let e=0;e<ageBrackets.length;e++){a+=h[e][t]}n.push(a)}for(let e=0;e<ageBrackets.length;e++){c[e]=doAvg(h[e],c[e]);S.push(dataSet(ageBracketsDisplay[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][0][e],c[e],"line"))}for(let a=g[0].length-howLongBack;a<g[0].length;a++){for(let e=0;e<g.length;e++){k[e].push(g[e][a])}}for(let a=h[0].length-howLongBack;a<h[0].length;a++){for(let e=0;e<h.length;e++){B[e].push(c[e][a])}}let D=7;for(let t=0;t<c[0].length;t++){for(let a=0;a<=18;a++){let e=getHalfRate(c[a][t],c[a][t-D],D);if(Math.abs(e)>70)e=null;u[a].push(e);i[a].push((c[a][t]/c[a][t-7]-1)*100)}}for(let a=i[0].length-howLongBack;a<i[0].length;a++){for(let e=0;e<i.length;e++){p[e].push(i[e][a]);d[e].push(u[e][a])}}for(let e=0;e<p[0].length;e++){l[0].push((p[0][e]+p[1][e]+p[2][e]+p[3][e])/4);l[1].push((p[4][e]+p[5][e]+p[6][e]+p[7][e])/4);l[2].push((p[8][e]+p[9][e]+p[10][e]+p[11][e])/4);l[3].push((p[12][e]+p[13][e]+p[14][e]+p[15][e])/4);l[4].push((p[16][e]+p[17][e]+p[18][e])/3)}for(let e=0;e<ageBrackets.length;e++){f.push(dataSet(ageBracketsDisplay[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][0][e],p[e],"line"));w.push(dataSet(ageBracketsDisplay[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][0][e],d[e],"line"));y.push(dataSet(ageBracketsDisplay[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][0][e],k[e],"line"));C.push(dataSet(ageBracketsDisplay[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][0][e],B[e],"line"))}for(let e=0;e<ageBracketsTwentys.length;e++){m.push(dataSet(ageBracketsTwentys[e],"rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][2][e],l[e],"line"))}let A=[...r];let b=[...s];A.pop();A.pop();A.pop();b.pop();b.pop();b.pop();chartWithTag("dailyCases","line",A,S);chartWithTag("dailyCasesShort","line",b,C);chartWithTag("casesChange","line",s,f,{scales:{xAxes:[{gridLines:{display:true,color:chartStyleColours[darkmode][0]}}],yAxes:[{ticks:{min:-55,max:55},gridLines:{display:true,color:chartStyleColours[darkmode][0],zeroLineColor:chartStyleColours[darkmode][1],zeroLineWidth:2}}]}});chartWithTag("casesChangeBands","line",s,m);chartWithTag("casesChangeHalf","line",s,w);chartWithTag("casesPer100000","line",s,y);valReturnSet([["howLongBack1",howLongBack.toString()],["howLongBack2",howLongBack.toString()],["howLongBack3",howLongBack.toString()],["howLongBack4",howLongBack.toString()]])}