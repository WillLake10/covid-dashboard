deaths("https://api.coronavirus.data.gov.uk/v1/data?"+"filters=areaType=overview&"+"structure={"+'"date":"date",'+'"newDeaths28DaysByPublishDate":"newDeaths28DaysByPublishDate",'+'"newCasesByPublishDate":"newCasesByPublishDate",'+'"newAdmissions":"newAdmissions"'+"}");async function deaths(e){const t=await fetch(e);const a=await t.json();const l=a.data.reverse();const o=15;const s=4;const r=56;const i=[],n=[],d=[],u=[];let c=[null,null,null,null];let y=[null,null,null,null];let h=[null,null,null,null];let p=[];let g=[];let b=[],C=[],m=[],x=[];for(let e=0;e<l.length;e++){const z=new Date(l[e].date);d.push(z.getDate()+"-"+(z.getMonth()+1));i.push(l[e].newCasesByPublishDate);if(e>=o){n.push(l[e].newDeaths28DaysByPublishDate)}if(e>=s){u.push(l[e].newAdmissions)}}while(u[u.length-1]==null)u.pop();while(n[n.length-1]==null)n.pop();c=doAvg(i,c);y=doAvg(n,y);h=doAvg(u,h);for(let e=c.length-r;e<c.length;e++){b.push(c[e]);x.push(d[e]);if(e<y.length)C.push(y[e]);if(e<h.length)m.push(h[e])}for(let e=0;e<c.length;e++){if(e<70){p.push(null)}else{p.push(y[e]/c[e])}}for(let e=0;e<c.length;e++){if(e<70){g.push(null)}else{g.push(h[e]/c[e])}}const k=200;const f=[],S=[];for(let e=p.length-k;e<p.length;e++){f.push(p[e]*100);if(e>p.length-k+13){S.push(d[e])}}const A=[],D=[];for(let e=g.length-k;e<g.length;e++){A.push(g[e]*100);if(e>g.length-k+8){D.push(d[e])}}for(let e=0;e<o;e++){f.pop()}for(let e=0;e<s;e++){A.pop()}console.log(y);let w=dataSet("Cumulative Second Dose","rgba(0, 0, 0, 0)",chartColours[darkmode][colourSequence][4][2],p,"line");new Chart(document.getElementById("caseDeathDiff").getContext("2d"),{type:"line",data:{labels:S,datasets:[{label:"Percent Deaths from Cases",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:chartColours[darkmode][colourSequence][4][2],data:f}]},options:{scales:{xAxes:[{stacked:true,gridLines:{display:true,color:chartStyleColours[darkmode][0]}}],yAxes:[{stacked:true,ticks:{beginAtZero:true},gridLines:{display:true,color:chartStyleColours[darkmode][0]}}]}}});new Chart(document.getElementById("hosDeathDiff").getContext("2d"),{type:"line",data:{labels:D,datasets:[{label:"Percent Hospital Admissions from Cases",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:chartColours[darkmode][colourSequence][4][2],data:A}]},options:{scales:{xAxes:[{stacked:true,gridLines:{display:true,color:chartStyleColours[darkmode][0]}}],yAxes:[{stacked:true,ticks:{beginAtZero:true},gridLines:{display:true,color:chartStyleColours[darkmode][0]}}]}}});new Chart(document.getElementById("caseDeathDiffAvg").getContext("2d"),{type:"line",data:{labels:S,datasets:[{label:"Percent Deaths from Cases Avg",backgroundColor:"rgba(0, 0, 0, 0)",borderColor:chartColours[darkmode][colourSequence][4][2],data:doAvgNoRound(f,[null,null,null])}]},options:{scales:{xAxes:[{stacked:true,gridLines:{display:true,color:chartStyleColours[darkmode][0]}}],yAxes:[{stacked:true,ticks:{beginAtZero:true},gridLines:{display:true,color:chartStyleColours[darkmode][0]}}]}}});let L=1200;let v=25;let M=86;let B=0;for(let e=0;e<c.length;e++){if(c[e]>B)B=c[e]}let I=Math.ceil(B/L)+1;new Chart(document.getElementById("caseDeathChart").getContext("2d"),{type:"line",data:{labels:d,datasets:[{label:"Cases",borderColor:chartColours[darkmode][colourSequence][4][0],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:c,yAxisID:"y-axis-1"},{label:"Deaths",borderColor:chartColours[darkmode][colourSequence][4][1],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:y,yAxisID:"y-axis-2"},{label:"Hospital Admissions",borderColor:chartColours[darkmode][colourSequence][4][2],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:h,yAxisID:"y-axis-3"}]},options:{responsive:true,hoverMode:"index",stacked:false,scales:{yAxes:[{type:"linear",display:true,position:"left",id:"y-axis-1",ticks:{min:0,max:L*I},scaleLabel:{display:true,labelString:"Cases",fontSize:20},gridLines:{display:true,color:chartStyleColours[darkmode][0]}},{type:"linear",display:true,position:"left",id:"y-axis-2",ticks:{min:0,max:v*I},scaleLabel:{display:true,labelString:"Deaths",fontSize:20},gridLines:{drawOnChartArea:false,display:true,color:chartStyleColours[darkmode][0]}},{type:"linear",display:true,position:"left",id:"y-axis-3",ticks:{min:0,max:M*I},scaleLabel:{display:true,labelString:"Hospital Admissions",fontSize:20},gridLines:{drawOnChartArea:false,display:true,color:chartStyleColours[darkmode][0]}}],xAxes:[{gridLines:{display:true,color:chartStyleColours[darkmode][0]}}]},plugins:{annotation:{annotations:{box1:{type:"box",xMin:1,xMax:2,yMin:5e3,yMax:7e4,backgroundColor:"rgba(255, 99, 132, 0.25)"}}}}}});let q=0;for(let e=0;e<b.length;e++){if(b[e]>q)q=b[e]}let P=Math.ceil(q/L);new Chart(document.getElementById("caseDeathChartShort").getContext("2d"),{type:"line",data:{labels:x,datasets:[{label:"Cases",borderColor:chartColours[darkmode][colourSequence][4][0],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:b,yAxisID:"y-axis-1"},{label:"Deaths",borderColor:chartColours[darkmode][colourSequence][4][1],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:C,yAxisID:"y-axis-2"},{label:"Hospital Admissions",borderColor:chartColours[darkmode][colourSequence][4][2],backgroundColor:"rgba(0, 0, 0, 0)",type:"line",data:m,yAxisID:"y-axis-3"}]},options:{responsive:true,hoverMode:"index",stacked:false,scales:{yAxes:[{type:"linear",display:true,position:"left",id:"y-axis-1",ticks:{min:0,max:L*P},scaleLabel:{display:true,labelString:"Cases",fontSize:20},gridLines:{display:true,color:chartStyleColours[darkmode][0]}},{type:"linear",display:true,position:"left",id:"y-axis-2",ticks:{min:0,max:v*P},scaleLabel:{display:true,labelString:"Deaths",fontSize:20},gridLines:{drawOnChartArea:false,display:true,color:chartStyleColours[darkmode][0]}},{type:"linear",display:true,position:"left",id:"y-axis-3",ticks:{min:0,max:M*P},scaleLabel:{display:true,labelString:"Hospital Admissions",fontSize:20},gridLines:{drawOnChartArea:false,display:true,color:chartStyleColours[darkmode][0]}}],xAxes:[{gridLines:{display:true,color:chartStyleColours[darkmode][0]}}]},plugins:{annotation:{annotations:{box1:{type:"box",xMin:1,xMax:2,yMin:5e3,yMax:7e4,backgroundColor:"rgba(255, 99, 132, 0.25)"}}}}}})}